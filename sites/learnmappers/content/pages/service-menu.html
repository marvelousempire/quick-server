<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<script src="../../config.js"></script>
<script>
  document.title = window.CONFIG?.site?.title ? `${window.CONFIG.site.name} ‚Äî Services (v${window.CONFIG.site.version})` : 'LearnMappers ‚Äî Services';
  document.querySelector('meta[name="theme-color"]')?.setAttribute('content', window.CONFIG?.site?.themeColor || '#0b0c10');
</script>
<title>LearnMappers ‚Äî Services</title>
<link rel="manifest" href="../../manifest.webmanifest"><meta name="theme-color" content="#0b0c10">
<style>
:root{ --bg:#0b0c10; --card:#0f131c; --ink:#e9f3ff; --muted:#9bb1c7; --brand:#7ce3ff; --brand2:#60ffa8; --line:#1e2636; --shadow:rgba(3,8,18,.5); --radius:16px; --gap:16px; }
*{box-sizing:border-box} html,body{background:radial-gradient(1200px 500px at 15% -10%, rgba(124,227,255,.14), transparent 50%), radial-gradient(900px 450px at 90% -10%, rgba(96,255,168,.09), transparent 60%), var(--bg);color:var(--ink);font-family:Inter,ui-sans-serif,-apple-system,Segoe UI,Roboto,Ubuntu,Arial,sans-serif;margin:0;line-height:1.6}
a{color:var(--brand);text-decoration:none}
main[data-page]{padding:0}
.wrap{max-width:1440px;margin:0 auto;padding:clamp(18px,4vw,60px)}
nav.stick{position:sticky;top:0;z-index:90;background:color-mix(in srgb, var(--bg) 86%, transparent);backdrop-filter: blur(10px);border-bottom:1px solid var(--line)}
nav .row{display:flex;align-items:center;justify-content:space-between;gap:12px}
.logo{display:flex;gap:10px;align-items:center;font-weight:900}
.logo .dot{width:12px;height:12px;border-radius:50%;background:linear-gradient(135deg,var(--brand),var(--brand2))}
nav .links{display:flex;gap:12px;flex-wrap:wrap}
nav .links a{padding:10px 12px;border-radius:12px}
nav .links a:hover{background:color-mix(in srgb, var(--brand) 18%, transparent)}
.pill{display:inline-flex;align-items:center;gap:6px;margin-right:8px;padding:6px 10px;border-radius:999px;border:1px solid var(--line);background:linear-gradient(180deg, color-mix(in srgb, var(--card) 90%, transparent), color-mix(in srgb, var(--card) 96%, transparent));font-size:12px}
.pill.online{color:#073b18;border-color:#0ea35a;background:linear-gradient(180deg,#d6ffe9,#f1fff7)}
.pill.offline{color:#4b1a1a;border-color:#cc5151;background:linear-gradient(180deg,#ffe3e3,#fff7f7)}
header.hero{position:relative;isolation:isolate;padding:54px 0 24px;margin-bottom:32px}
header.hero.wrap{padding-top:54px;padding-bottom:24px;padding-left:clamp(18px,4vw,60px);padding-right:clamp(18px,4vw,60px)}
h1{font-size:clamp(36px,5vw,56px);margin:0 0 12px;font-weight:900;background:linear-gradient(135deg,var(--ink) 0%,var(--brand) 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.lead{font-size:clamp(16px,2.2vw,19px);color:var(--muted);max-width:74ch;margin:0 0 20px;line-height:1.6}
.btn{padding:12px 16px;border-radius:14px;border:1px solid var(--line);background:linear-gradient(180deg, color-mix(in srgb, var(--card) 85%, transparent), color-mix(in srgb, var(--card) 95%, transparent));color:var(--ink);font-weight:800;cursor:pointer;transition:.18s ease;box-shadow:0 14px 40px -20px var(--shadow);text-decoration:none;display:inline-block}
.btn:hover{transform:translateY(-2px)}
.btn.brand{background:linear-gradient(135deg,var(--brand),#c9f5ff);color:#041018;border:none}
.card{background:linear-gradient(180deg, color-mix(in srgb, var(--card) 88%, transparent), color-mix(in srgb, var(--card) 97%, transparent));border:1px solid var(--line);border-radius:var(--radius);padding:24px;box-shadow:0 14px 44px -28px var(--shadow);transition:all 0.2s}
.card:hover{border-color:var(--brand);transform:translateY(-2px);box-shadow:0 20px 48px -16px var(--shadow)}
.section{margin:48px 0}
.section h2{font-size:32px;font-weight:900;margin:0 0 24px;padding-top:16px;border-top:1px solid var(--line);margin-top:32px}
.section h2:first-child{border-top:none;margin-top:0;padding-top:0}
.section h3{font-size:24px;font-weight:800;margin:32px 0 16px}
.section p{margin:16px 0;font-size:16px;line-height:1.7;color:var(--ink)}
.section ul,.section ol{margin:16px 0;padding-left:24px}
.section li{margin:8px 0;line-height:1.6}
.service-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:20px;margin:32px 0}
.service-card h3{margin:0 0 12px;font-size:20px;font-weight:900;color:var(--ink);display:flex;align-items:center;gap:10px}
.service-card h3 .icon{font-size:24px;opacity:0.8}
.service-card .description{color:var(--muted);font-size:14px;line-height:1.6;margin:0 0 16px}
.service-card .features{list-style:none;padding:0;margin:0 0 16px}
.service-card .features li{color:var(--muted);font-size:13px;padding:6px 0;padding-left:20px;position:relative}
.service-card .features li::before{content:'‚úì';position:absolute;left:0;color:var(--brand2);font-weight:900}
.service-card .tags{display:flex;flex-wrap:wrap;gap:6px;margin-top:12px}
.service-card .tag{font-size:11px;padding:4px 10px;border-radius:6px;background:color-mix(in srgb, var(--card) 90%, transparent);border:1px solid var(--line);color:var(--muted);text-transform:uppercase;font-weight:700;letter-spacing:0.5px}
.service-card .cta{margin-top:16px;display:flex;gap:8px;flex-wrap:wrap}
.filter-bar{display:flex;gap:10px;flex-wrap:wrap;margin:24px 0;padding:16px;background:color-mix(in srgb, var(--card) 88%, transparent);border:1px solid var(--line);border-radius:12px;align-items:center}
.filter-bar label{font-size:12px;font-weight:700;text-transform:uppercase;letter-spacing:0.5px;color:var(--muted)}
.filter-btn{font-size:13px;padding:8px 14px;border-radius:8px;border:1px solid var(--line);background:color-mix(in srgb, var(--card) 90%, transparent);color:var(--muted);cursor:pointer;transition:all 0.15s;font-weight:600}
.filter-btn:hover{background:color-mix(in srgb, var(--brand) 12%, transparent);color:var(--ink);border-color:var(--brand)}
.filter-btn.active{background:color-mix(in srgb, var(--brand) 20%, transparent);color:var(--brand);border-color:var(--brand);font-weight:800}
.about-section{background:linear-gradient(180deg, color-mix(in srgb, var(--card) 88%, transparent), color-mix(in srgb, var(--card) 97%, transparent));border:1px solid var(--line);border-radius:16px;padding:32px;margin:32px 0}
.about-section h3{margin-top:0}
.about-section p{color:var(--muted);line-height:1.7}
.values-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:16px;margin:24px 0}
.value-card{background:color-mix(in srgb, var(--card) 90%, transparent);border:1px solid var(--line);border-radius:12px;padding:20px;text-align:center}
.value-card h4{margin:0 0 8px;font-size:18px;font-weight:900;color:var(--brand)}
.value-card p{margin:0;font-size:14px;color:var(--muted);line-height:1.5}
@media print{ nav,.filter-bar,.btn{display:none!important} body{background:#fff;color:#111} .card{background:#fff;border:1px solid #ddd} }
</style>
</head>
<body>
<nav class="stick wrap">
  <div class="row">
    <a href="/" class="logo" id="logo">
      <span class="dot"></span>
      <span>LearnMappers</span>
    </a>
    <div class="links">
      <span id="netPill" class="pill" title="Connection status">‚óè offline</span>
      <div id="navLinks">
        <!-- Navigation links will be populated from config.json -->
        <a href="index.html" data-nav>Home</a>
        <a href="about.html" data-nav>About</a>
        <a href="inventory.html" data-nav>Resources</a>
        <a href="service-menu.html" data-nav>Services</a>
        <a href="settings.html" data-nav>Settings</a>
      </div>
    </div>
  </div>
</nav>

<main data-page>
  <section class="wrap">
    <header class="hero" id="serviceHero">
      <h1 id="serviceTitle">Our Services</h1>
      <p class="lead" id="serviceDescription">Headquarters Development ‚Ä¢ Family Office Administration ‚Äî Complete solutions from homesteading and handyman services to administrative excellence, tech support, systems management, and compliance. We bridge hands-on craft with systems thinking.</p>
      <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:20px" id="serviceCta"></div>
    </header>

    <div class="section">
      <div class="about-section">
        <h3>Who We Are</h3>
        <p>LearnMappers bridges hands-on craft and systems thinking. We provide comprehensive Headquarters Development (homesteading, handyman, carpentry, electrical, gardening) and Family Office Administration (administrative services, tech support, systems management, compliance, education). Our approach combines practical expertise with systematic problem-solving‚Äîteaching you not just how to do it, but how to think about it.</p>
        <p>We're not just service providers‚Äîwe're educators and system builders. Every project, whether physical or administrative, is an opportunity to teach, document, and build sustainable solutions that work for you long-term. We map your setup so you can keep it working‚Äîat home, in the office, and across your operations.</p>
      </div>
    </div>

    <div class="section">
      <h2>What We Do</h2>
      <p>Our services span two comprehensive areas: <strong>Headquarters Development</strong> (homesteading, handyman, carpentry, electrical, gardening, home improvement) and <strong>Family Office Administration</strong> (administrative services, tech support, systems management, compliance, education). Each service is delivered with documentation, best practices, and systems thinking ‚Äî mapping your setup so you can keep it working.</p>

      <div class="filter-bar">
        <label>Filter:</label>
        <button class="filter-btn active" data-filter="all">All Services</button>
        <button class="filter-btn" data-filter="assembly">Assembly</button>
        <button class="filter-btn" data-filter="tech">Tech</button>
        <button class="filter-btn" data-filter="smart">Smart Home</button>
        <button class="filter-btn" data-filter="eco">Eco</button>
        <button class="filter-btn" data-filter="creative">Creative</button>
      </div>

      <div class="service-grid" id="servicesGrid">
        <!-- Services will be populated from config.json -->
      </div>
    </div>

    <div class="section">
      <h2>Our Approach</h2>
      <p>Every project follows our core philosophy: <strong>Teach. Build. Sustain.</strong> We don't just complete tasks‚Äîwe build systems, document processes, and empower you to maintain and extend what we create.</p>

      <div class="values-grid">
        <div class="value-card">
          <h4>üéì Education First</h4>
          <p>We teach you how things work, not just how to use them. Every project includes documentation and knowledge transfer.</p>
        </div>
        <div class="value-card">
          <h4>üîß Systems Thinking</h4>
          <p>We build solutions that work together. Every component is designed to integrate with your existing systems.</p>
        </div>
        <div class="value-card">
          <h4>üìö Documentation</h4>
          <p>Nothing is left undocumented. You'll have guides, schematics, and maintenance instructions for everything we build.</p>
        </div>
        <div class="value-card">
          <h4>‚ôªÔ∏è Sustainability</h4>
          <p>We build for the long term. Solutions are designed to be maintainable, upgradeable, and sustainable.</p>
        </div>
        <div class="value-card">
          <h4>üîí Privacy & Security</h4>
          <p>Your data, your systems, your control. We prioritize privacy and security in everything we do.</p>
        </div>
        <div class="value-card">
          <h4>ü§ù Partnership</h4>
          <p>We're not just contractors‚Äîwe're partners in building your systems. Long-term relationships, not one-time transactions.</p>
        </div>
      </div>
    </div>

    <div class="section">
      <h2>Why LearnMappers?</h2>
      <p>Most service providers complete a task and leave. We're different. We build systems, document processes, and empower you to maintain and extend what we create. Every project is an opportunity to teach, document, and build sustainable solutions.</p>
      
      <div class="about-section">
        <h3>What Makes Us Different</h3>
        <ul style="color:var(--muted);line-height:1.8">
          <li><strong>Systems Approach:</strong> We don't just fix problems‚Äîwe build systems that prevent them. Every solution is designed to work with your existing infrastructure.</li>
          <li><strong>Documentation:</strong> Nothing is left undocumented. You'll receive guides, schematics, maintenance instructions, and troubleshooting documentation for everything we build.</li>
          <li><strong>Knowledge Transfer:</strong> We teach you how things work. By the end of a project, you understand the system, not just how to use it.</li>
          <li><strong>Long-Term Thinking:</strong> We build for sustainability. Solutions are designed to be maintainable, upgradeable, and adaptable to future needs.</li>
          <li><strong>Integration:</strong> Everything we build integrates with your existing systems. No silos, no isolated solutions‚Äîeverything works together.</li>
        </ul>
      </div>
    </div>

    <div class="section" style="text-align:center;padding:32px 0;border-top:1px solid var(--line);margin-top:48px">
      <h2>Ready to Get Started?</h2>
      <p style="color:var(--muted);margin-bottom:24px">Book a service today and experience the LearnMappers difference.</p>
      <a href="https://www.taskrabbit.com/profile/marvin-h--14?utm_source=learnmappers_site&utm_medium=services&utm_campaign=cta" target="_blank" rel="noopener" class="btn brand" style="font-size:16px;padding:14px 24px">üìÖ Book a Service</a>
    </div>
  </section>
</main>

<script>
// Filter functionality (re-initialized after services are populated)
function initFilters() {
  const filterBtns = document.querySelectorAll('.filter-btn');
  const serviceCards = document.querySelectorAll('.service-card');
  
  console.log('üîç Initializing filters:', filterBtns.length, 'buttons,', serviceCards.length, 'cards');
  
  if (filterBtns.length === 0) {
    console.warn('‚ö†Ô∏è  No filter buttons found');
    return;
  }
  
  if (serviceCards.length === 0) {
    console.warn('‚ö†Ô∏è  No service cards found - filters will be initialized after services load');
    // Don't return - still initialize filter buttons so they work when cards are added
  }
  
  filterBtns.forEach(btn => {
    // Remove old listeners by cloning
    const newBtn = btn.cloneNode(true);
    btn.parentNode.replaceChild(newBtn, btn);
    
    newBtn.addEventListener('click', () => {
      // Update active state
      document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
      newBtn.classList.add('active');
      
      // Get filter value
      const filter = newBtn.dataset.filter;
      console.log('üîç Filter clicked:', filter);
      
      // Re-query service cards to get fresh references (in case they were added dynamically)
      const currentServiceCards = document.querySelectorAll('.service-card');
      console.log('üîç Found', currentServiceCards.length, 'service cards to filter');
      
      // Filter cards
      let visibleCount = 0;
      currentServiceCards.forEach(card => {
        const categoryId = (card.dataset.category || '').toLowerCase();
        const categoryTitle = card.querySelector('.tag')?.textContent?.toLowerCase() || '';
        const serviceTitle = card.querySelector('h3')?.textContent?.toLowerCase() || '';
        
        // Debug logging for first few cards
        if (visibleCount < 3) {
          console.log('üîç Card:', {
            categoryId,
            categoryTitle,
            serviceTitle: serviceTitle.substring(0, 30),
            filter
          });
        }
        
        // Check if this card matches the filter
        let shouldShow = false;
        if (filter === 'all') {
          shouldShow = true;
        } else {
          const filterLower = filter.toLowerCase();
          
          // Define category mappings for filter buttons
          const categoryMappings = {
            'assembly': ['assembly', 'mounting'],
            'tech': ['apple-linux', 'ai-rag', 'office-tech', 'ai-systems', 'tech'],
            'smart': ['smart-home', 'smart', 'automation', 'home-automation'],
            'eco': ['solar', 'garden', 'energy-outdoor', 'eco', 'sustainability'],
            'creative': ['media', 'photo', 'video', 'design', 'creative']
          };
          
          // Get matching category IDs for this filter
          const matchingCategories = categoryMappings[filter] || [];
          
          // Check if category ID matches any of the mapped categories
          const categoryMatches = matchingCategories.some(mappedCat => 
            categoryId === mappedCat || categoryId.includes(mappedCat) || mappedCat.includes(categoryId)
          );
          
          // Direct match on category ID
          if (categoryId === filterLower || categoryId.includes(filterLower)) {
            shouldShow = true;
          }
          // Check against category mappings
          else if (categoryMatches) {
            shouldShow = true;
          }
          // Check category title tag
          else if (categoryTitle.includes(filterLower)) {
            shouldShow = true;
          }
          // Check service title
          else if (serviceTitle.includes(filterLower)) {
            shouldShow = true;
          }
          // Fallback: check if any mapped category keyword appears in category ID
          else if (matchingCategories.some(mappedCat => categoryId.includes(mappedCat.split('-')[0]))) {
            shouldShow = true;
          }
        }
        
        if (shouldShow) {
          card.style.display = '';
          visibleCount++;
        } else {
          card.style.display = 'none';
        }
      });
      
      console.log('‚úÖ Filter applied:', filter, '-', visibleCount, 'services visible');
    });
  });
  
  console.log('‚úÖ Filters initialized');
}

// Initialize filters on page load (will be re-initialized after services load)
// Don't call immediately - wait for services to be rendered
// initFilters() will be called after services are loaded

/* v7.3 net pill */
(function(){
  const el = document.getElementById('netPill'); if(!el) return;
  function setStatus(){
    const on = navigator.onLine;
    el.textContent = (on ? '‚óè online' : '‚óè offline');
    el.classList.toggle('online', on);
    el.classList.toggle('offline', !on);
  }
  window.addEventListener('online', setStatus);
  window.addEventListener('offline', setStatus);
  setStatus();
})();
</script>
<script src="../../scripts.js"></script>
<script>if('serviceWorker' in navigator){navigator.serviceWorker.register('../../service-worker.js').catch(()=>{});}</script>
<script>
// Populate services from config
let populateServicesRunning = false;
window.populateServices = function populateServices() {
  // Prevent multiple simultaneous executions
  if (populateServicesRunning) {
    console.log('‚è≥ populateServices already running, skipping...');
    return;
  }
  
  const config = window.CONFIG || {};
  populateServicesRunning = true;
  console.log('üîÑ populateServices called, CONFIG available:', !!window.CONFIG);

  // Find servicesGrid element - try multiple times if needed
  const servicesGrid = document.getElementById('servicesGrid');
  if (!servicesGrid) {
    console.error('‚ùå servicesGrid element not found in DOM, retrying in 100ms...');
    populateServicesRunning = false;
    setTimeout(() => {
      window.populateServices();
    }, 100);
    return;
  }

  console.log('‚úÖ Found servicesGrid element');

  // Update logo and navigation
  const logo = document.getElementById('logo');
  if (logo && config.navigation?.logo) {
    logo.innerHTML = `
      ${config.navigation.logo.showDot ? '<span class="dot"></span>' : ''}
      <span>${config.navigation.logo.text || 'LearnMappers'}</span>
    `;
    if (config.navigation.logo.href) logo.href = config.navigation.logo.href;
  }

  const navLinks = document.getElementById('navLinks');
  if (navLinks && config.navigation?.links) {
    navLinks.innerHTML = config.navigation.links.map(link => 
      `<a href="${link.href}" data-nav>${link.icon ? link.icon + ' ' : ''}${link.label}</a>`
    ).join('');
  }

  // Update service hero section
  const serviceTitle = document.getElementById('serviceTitle');
  const serviceDescription = document.getElementById('serviceDescription');
  const serviceCta = document.getElementById('serviceCta');
  
  if (serviceTitle) serviceTitle.textContent = 'Our Services';
  if (serviceDescription && config.site?.tagline) {
    serviceDescription.textContent = `${config.site.tagline} ‚Äî Complete solutions from homesteading and handyman services to administrative excellence, tech support, systems management, and compliance. We bridge hands-on craft with systems thinking.`;
  }
  
  if (serviceCta && config.contact?.booking?.enabled) {
    const booking = config.contact.booking;
    serviceCta.innerHTML = `
      <a href="${booking.primaryLink}" target="_blank" rel="noopener" class="btn brand">üìÖ ${booking.primaryText || 'Book a Service'}</a>
      <button class="btn" onclick="window.print()">üñ®Ô∏è Print Service Menu</button>
    `;
  }

  // Populate services grid
  // Shared services array
  let allServices = [];
  
  function renderServices() {
    if (!servicesGrid) {
      console.error('‚ùå servicesGrid element not found');
      return;
    }
    
    if (allServices.length === 0) {
      console.warn('‚ö†Ô∏è  No services to render');
      servicesGrid.innerHTML = '<div class="card" style="text-align: center; padding: 40px;"><p style="color: var(--muted);">No services available at this time.</p></div>';
      populateServicesRunning = false;
      return;
    }
    
    console.log('‚úÖ Rendering', allServices.length, 'services');
    console.log('‚úÖ Sample service:', allServices[0]);
    
    const taskrabbitUrl = (config && config.integrations?.taskrabbit?.profileUrl) || 'https://www.taskrabbit.com/profile/marvin-h--14';
    const utmSource = (config && config.integrations?.taskrabbit?.utmSource) || 'learnmappers_site';
    const utmMedium = (config && config.integrations?.taskrabbit?.utmMedium) || 'services';
    
    const html = allServices.map(service => {
        if (!service || !service.id) {
          console.warn('‚ö†Ô∏è  Invalid service:', service);
          return '';
        }
        
        const bookingUrl = `${taskrabbitUrl}?utm_source=${utmSource}&utm_medium=${utmMedium}&utm_campaign=${service.id || 'service'}`;
        // From content/pages/service-menu.html, service cards are at ../../pages/service-cards/
        // Use absolute path for reliability: /sites/learnmappers/pages/service-cards/{id}.html
        const servicePageUrl = service.id ? `/sites/learnmappers/pages/service-cards/${service.id}.html` : '#';
        const featuresList = service.features ? service.features.map(f => `<li>${f}</li>`).join('') : '';
        const toolsList = (config && config.content?.services?.showTools && service.tools) ? service.tools.map(t => `<span class="tag">${t}</span>`).join('') : '';
        const pricing = service.pricing?.rate ? `$${service.pricing.rate}/${service.pricing.type === 'hourly' ? 'hr' : 'fixed'}` : (typeof service.pricing === 'string' ? service.pricing : 'Contact for pricing');
        
        // Determine category for filtering
        const serviceCategory = service.categoryId || service.category || service.id || '';
        
      return `
        <div class="service-card card" data-category="${serviceCategory}">
          <h3><a href="${servicePageUrl}" style="color:inherit;text-decoration:none;display:flex;align-items:center;gap:10px" data-nav>
            <span class="icon">${service.icon || '‚öôÔ∏è'}</span> ${service.title || service.id}
          </a></h3>
          <p class="description">${service.description || service.purpose || ''}</p>
          ${featuresList ? `<ul class="features">${featuresList}</ul>` : ''}
          <div class="tags">
            ${toolsList || ''}
            ${pricing ? `<span class="tag">${pricing}</span>` : ''}
            ${service.duration ? `<span class="tag">${service.duration}</span>` : ''}
            ${service.categoryTitle ? `<span class="tag">${service.categoryTitle}</span>` : ''}
          </div>
          <div class="cta">
            <a href="${servicePageUrl}" class="btn" style="font-size:13px;padding:8px 14px" data-nav>View Details</a>
            <a href="${bookingUrl}" target="_blank" rel="noopener" class="btn brand" style="font-size:13px;padding:8px 14px">Book Now</a>
          </div>
        </div>
      `;
    }).join('');
    
    console.log('‚úÖ Generated HTML for', allServices.length, 'services, length:', html.length);
    servicesGrid.innerHTML = html;
    
    // Re-initialize filter functionality after services are rendered
    // Use setTimeout to ensure DOM is updated
    setTimeout(() => {
      if (typeof initFilters === 'function') {
        console.log('üîÑ Re-initializing filters after services rendered...');
        initFilters();
      } else {
        console.warn('‚ö†Ô∏è  initFilters function not found');
      }
    }, 200);
  }
    
    // Load services from API or config
    async function loadServices() {
      try {
        console.log('üì° Loading services from API...');
        const apiUrl = window.location.origin + '/api/services';
        console.log('üì° API URL:', apiUrl);
        const response = await fetch(apiUrl);
        console.log('üì° API response status:', response.status, response.ok);
        if (response.ok) {
          const apiServices = await response.json();
          console.log('üì° API returned', Array.isArray(apiServices) ? apiServices.length : 'non-array', 'services');
          console.log('üì° API services sample:', Array.isArray(apiServices) ? apiServices.slice(0, 2) : apiServices);
          
          // Handle both array and object responses
          let servicesArray = [];
          if (Array.isArray(apiServices)) {
            servicesArray = apiServices;
          } else if (apiServices && typeof apiServices === 'object') {
            // If it's an object, try to extract services array
            servicesArray = apiServices.services || apiServices.data || [apiServices];
          }
          
          if (servicesArray.length > 0) {
            allServices = servicesArray.map(service => ({
              ...service,
              categoryId: service.categoryId || service.category || service.id || '',
              category: service.category || service.categoryId || service.id || '',
              categoryTitle: service.categoryTitle || service.category || ''
            }));
            console.log('‚úÖ Loaded', allServices.length, 'services from API');
            console.log('‚úÖ First service:', allServices[0]?.id, allServices[0]?.title);
            renderServices();
            populateServicesRunning = false;
            return;
          } else {
            console.log('‚ö†Ô∏è  API returned empty array, trying config.json...');
          }
        } else {
          console.log('‚ö†Ô∏è  API returned status:', response.status, 'trying config.json...');
        }
      } catch (e) {
        console.error('‚ö†Ô∏è  Could not load services from API, using config.json...', e);
        console.error('‚ö†Ô∏è  Error details:', e.message, e.stack);
      }
      
      // Fallback to config.json
      if (config.content?.services?.categories) {
        console.log('üìã Loading services from config.json...');
        // Flatten nested structure: categories can contain either services array or be services themselves
        config.content.services.categories.forEach(category => {
          if (category.services && Array.isArray(category.services)) {
            // Category has nested services array
            category.services.forEach(service => {
              allServices.push({
                ...service,
                categoryId: service.categoryId || service.category || category.id,
                category: service.category || category.id,
                categoryTitle: category.title
              });
            });
          } else {
            // Category is itself a service (legacy format)
            allServices.push(category);
          }
        });
        
        console.log('‚úÖ Loaded', allServices.length, 'services from config.json');
        console.log('‚úÖ First service from config:', allServices[0]?.id, allServices[0]?.title);
        renderServices();
        populateServicesRunning = false;
      } else {
        console.error('‚ùå No services found in config.json');
        if (servicesGrid) {
          servicesGrid.innerHTML = '<div class="card" style="text-align: center; padding: 40px;"><p style="color: var(--muted);">No services available at this time.</p></div>';
        }
        populateServicesRunning = false;
      }
    }
    
  // Load services
  loadServices().catch(err => {
    console.error('‚ùå Error loading services:', err);
    populateServicesRunning = false;
    if (servicesGrid) {
      servicesGrid.innerHTML = '<div class="card" style="text-align: center; padding: 40px;"><p style="color: var(--muted);">Error loading services. Please refresh the page.</p></div>';
    }
  });
}

// Listen for config loaded
window.addEventListener('configLoaded', populateServices);

// Listen for route changes (when router loads new content)
window.addEventListener('routeChanged', () => {
  console.log('üîÑ Route changed, re-populating services...');
  setTimeout(populateServices, 100);
});

// Also try on DOM ready
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', populateServices);
} else {
  // DOM already loaded
  populateServices();
}

// Also try after a short delay to ensure everything is ready
setTimeout(() => {
  const grid = document.getElementById('servicesGrid');
  if (grid && grid.innerHTML.trim() === '<!-- Services will be populated from config.json -->') {
    console.log('üîÑ servicesGrid still empty, retrying populateServices...');
    populateServices();
  }
}, 500);
</script>
<script>
/* v7.3 net pill */
(function(){
  const el = document.getElementById('netPill'); if(!el) return;
  function setStatus(){
    const on = navigator.onLine;
    el.textContent = (on ? '‚óè online' : '‚óè offline');
    el.classList.toggle('online', on);
    el.classList.toggle('offline', !on);
  }
  window.addEventListener('online', setStatus);
  window.addEventListener('offline', setStatus);
  setStatus();
})();

// Suppress WebSocket errors from development tools (like Cursor)
window.addEventListener('error', (e) => {
  if (e.message && e.message.includes('WebSocket') && e.message.includes('3001')) {
    e.preventDefault();
    console.warn('‚ö†Ô∏è  WebSocket connection to dev tools failed (this is harmless)');
    return false;
  }
}, true);
</script>
</body>
</html>
